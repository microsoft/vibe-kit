# Aurora Norway Coastal Forecast - Reference Implementation

**Study this code, understand how it works, then adapt it for YOUR scenario.**

This is a complete working example showing Aurora's 24-hour weather forecasting capabilities over Norway's coastal region (58.25¬∞N-70¬∞N, 5¬∞E-16.75¬∞E). It's designed as a reference implementation you can learn from and modify.

---

## üéØ What's Included

‚úÖ **Aurora inference script** (`scripts/run_aurora_inference.py`)  
- 48√ó48 grid at 0.25¬∞ resolution
- 4-step forecast (June 8: 00:00, 06:00, 12:00, 18:00)
- Uses last 2 CDS timesteps as input (June 7: 12:00, 18:00)

‚úÖ **Frontend visualization** (`frontend/`)  
- React 18 + Fluent UI v9
- Canvas-based heatmap with time slider
- Toggle between CDS observations (June 1-7) and Aurora predictions (June 8)

‚úÖ **Sample input data** (`data/` folder, 4.7MB total)  
- CDS ERA5 surface variables (June 1-7, 2025)
- CDS ERA5 atmospheric variables (June 1-7, 2025)
- **Note:** Aurora forecast output (`aurora_forecast_june8.nc`) is generated by running inference

‚úÖ **Complete documentation**  
- This README - End-to-end workflow
- `AURORA_INFERENCE_GUIDE.md` - Technical deep-dive

---

## üìã Prerequisites

- **Vibe Kit** with Aurora Innovation Kit installed
- **Python 3.12+** with `uv` or `pip`
- **Node.js 18+** with `pnpm`
- **Dev container recommended** (all dependencies pre-configured)

---

## Learning Path

1. **Run the example** (30 min) ‚Üí [quick-start.md](.vibe-kit/innovation-kits/aurora/docs/quick-start.md)
2. **Understand internals** (1 hour) ‚Üí `AURORA_INFERENCE_GUIDE.md` or [norway-technical-guide.md](.vibe-kit/innovation-kits/aurora/docs/norway-technical-guide.md)
3. **Build your own** (4-8 hours) ‚Üí [prototyping-guide.md](.vibe-kit/innovation-kits/aurora/docs/prototyping-guide.md)

---

## üöÄ Quick Start

### Option A: Use GitHub Copilot (Recommended)

**See [.vibe-kit/innovation-kits/aurora/docs/quick-start.md](.vibe-kit/innovation-kits/aurora/docs/quick-start.md)** for the full tutorial.

**TL;DR:**
```bash
# 1. Launch frontend
cd frontend
pnpm install
pnpm dev
# Open http://localhost:5174

# 2. Run inference (guided by Copilot)
pip install -r scripts/requirements.txt
python3 scripts/run_aurora_inference.py

# 3. Convert to TypeScript
python3 scripts/build_forecast_module.py \
  data/aurora_forecast_june8.nc \
  --output frontend/src/data/auroraForecastPredictions.ts \
  --max-steps 4


# 4. Refresh browser (Ctrl+Shift+R)
```

---

## üîë Key Technical Details

- **Grid:** 48√ó48 cells (divisible by patch_size=16)
- **Forecast:** 24 hours (4 steps at 6-hour intervals)
- **Input:** 2 consecutive timesteps (captures state + trends)
- **Model:** AuroraSmall pretrained (1.3B parameters)
- **Stability:** 24h horizon optimal for 48√ó48 regional grid

**Why these choices?** See `AURORA_INFERENCE_GUIDE.md` for complete technical rationale.

---

## üõ†Ô∏è Adapting This Example

**Change region:**
- Modify lat/lon bounds in `run_aurora_inference.py`
- Ensure grid dimensions divisible by 16
- See [prototyping-guide.md](.vibe-kit/innovation-kits/aurora/docs/prototyping-guide.md)

**Extend forecast:**
- Increase `num_steps` in `run_aurora_inference.py`
- Test for model divergence (temps < -20¬∞C = bad)
- 24-48 hours usually stable for regional grids

**Add variables:**
- Edit `save_forecast_netcdf()` to include more vars
- Update `build_forecast_module.py` variable list
- Modify `HeatmapOverlay.tsx` colormap

---

## üìÇ Project Structure

```
norway-example/
‚îú‚îÄ‚îÄ README.md                       # üëà You are here
‚îú‚îÄ‚îÄ AURORA_INFERENCE_GUIDE.md       # Technical deep-dive
‚îú‚îÄ‚îÄ data/                           # Input NetCDF files (4.7MB)
‚îÇ   ‚îú‚îÄ‚îÄ 4d2238a45558de23ef37ca2e27a0315.nc         # CDS surface/static
‚îÇ   ‚îú‚îÄ‚îÄ 4a1f46cd2447ab83c1f564af59d53023.nc        # CDS atmospheric
‚îÇ   ‚îî‚îÄ‚îÄ cds_observations_48x48.nc                 # Cropped to 48√ó48
‚îÇ       # aurora_forecast_june8.nc (generated by running inference)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ run_aurora_inference.py     # Core inference script
‚îÇ   ‚îú‚îÄ‚îÄ build_forecast_module.py    # NetCDF ‚Üí TypeScript
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt            # Python dependencies
‚îî‚îÄ‚îÄ frontend/
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                 # Main UI
    ‚îÇ   ‚îú‚îÄ‚îÄ components/             # HeatmapOverlay
    ‚îÇ   ‚îî‚îÄ‚îÄ data/                   # TypeScript forecast modules
    ‚îú‚îÄ‚îÄ package.json
    ‚îî‚îÄ‚îÄ vite.config.ts
```

---

## ‚ö†Ô∏è Troubleshooting

**Common issues:**
- Grid not divisible by 16 ‚Üí See [emergency-fixes.md](.vibe-kit/innovation-kits/aurora/docs/emergency-fixes.md)
- Model divergence ‚Üí Reduce forecast steps
- Timezone display wrong ‚Üí Check 'Z' suffix in timestamps
- Frontend empty ‚Üí Did you regenerate TypeScript modules?

**Regional grid stability (48√ó48 cells):**

Aurora accumulates small errors over autoregressive steps. On a **48√ó48 regional grid**, boundary condition errors grow faster than on global grids:

- **4 steps (24h):** Stable, realistic temperatures

**Why?** The 48√ó48 grid lacks surrounding atmospheric context. Weather systems moving in from boundaries are not properly represented, causing the model to drift from realistic states over long forecasts.

**Solutions:**
- Keep forecast horizons ‚â§ 48 hours for regional grids
- Use larger grids (e.g., 96√ó96 or 128√ó128) for longer forecasts
- Consider global grids if you need week-long predictions

---

## üìñ Next Steps

‚úÖ **Got this working?** Build your own prototype:
- [prototyping-guide.md](.vibe-kit/innovation-kits/aurora/docs/prototyping-guide.md) - Adapt for your region
- [data-integration.md](.vibe-kit/innovation-kits/aurora/docs/data-integration.md) - Connect your data
- [application-patterns.md](.vibe-kit/innovation-kits/aurora/docs/application-patterns.md) - See other scenarios

---

**Part of:** [Aurora Innovation Kit](.vibe-kit/innovation-kits/aurora/INNOVATION_KIT.md)
